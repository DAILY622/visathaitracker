<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VisaTracker Thailand</title>
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="presskit/favicon.png" type="image/png">
  <link rel="apple-touch-icon" href="presskit/icon-512.png">
  <meta name="theme-color" content="#1a73e8">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cal-heatmap@4.0.0/cal-heatmap.css" />
  <script src="https://cdn.jsdelivr.net/npm/cal-heatmap@4.0.0/cal-heatmap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.emailjs.com/dist/email.min.js"></script>
  <style>
    body { 
      font-family: sans-serif; 
      margin: 0; 
      padding: 2rem; 
      max-width: 800px; 
      margin: auto; 
    }
    .button-group { 
      margin: 1rem 0; 
    }
    .button-group button { 
      margin: 0.5rem; 
      padding: 0.5rem 1rem; 
    }
    .tabSection {
      margin-top: 2rem;
    }
    .tabBtn {
      padding: 0.5rem 1rem;
      margin: 0.25rem;
      border: 1px solid #ccc;
      background: #f8f9fa;
      border-radius: 4px;
      cursor: pointer;
    }
    .tabBtn.active {
      background: #007bff;
      color: white;
    }
    input[type="date"], input[type="email"], input[type="text"], textarea, select {
      padding: 0.5rem;
      font-size: 1rem;
      border: 1px solid #ccc;
      border-radius: 5px;
      margin: 0.25rem 0;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
    }
    th, td {
      padding: 0.5rem;
      border: 1px solid #ccc;
      text-align: left;
    }
    th {
      background: #f0f0f0;
    }
  </style>
</head>
<body>
  <div id="app">
    <h1 id="welcome">🇹🇭 Welcome to VisaTracker Thailand</h1>
    
    <div class="button-group">
      <button id="helloBtn">👋 Hello</button>
      <button id="loginBtn">Login</button>
      <button id="logoutBtn">Logout</button>
      <button id="profileBtn">Profile</button>
      <button id="questsBtn">Quests</button>
      <button id="rewardsBtn">Rewards</button>
    </div>

    <div style="margin: 1rem 0;">
      <label for="lang">🌐 Language:</label>
      <select id="lang" onchange="switchLang(this.value)">
        <option value="en">🇬🇧 English</option>
        <option value="th">🇹🇭 ภาษาไทย</option>
      </select>
    </div>

    <nav id="navTabs" style="margin: 1rem 0;">
      <button class="tabBtn active" onclick="showTab('home')">🏠 Home</button>
      <button class="tabBtn" onclick="showTab('checklist')">✅ Checklist</button>
      <button class="tabBtn" onclick="showTab('countdown')">⏳ Countdown</button>
      <button class="tabBtn" onclick="showTab('tm30')">🧾 TM30</button>
      <button class="tabBtn" onclick="showTab('visaTypes')">📅 Visa Types</button>
    </nav>

    <!-- Home Tab -->
    <div id="tab-home" class="tabSection">
      <p>Your personal visa and TM30 companion — powered by AI, OCR, and Firebase.</p>
      <ul style="line-height: 1.8;">
        <li>✅ Track visa expiry, TM30, and 90-day reports</li>
        <li>📤 Upload and scan visa documents with OCR</li>
        <li>🧠 Get AI-powered reminders and visa suggestions</li>
        <li>📅 Schedule appointments and sync to Google Calendar</li>
        <li>🔐 Use biometric login and install as a mobile app</li>
        <li>📦 Visualize your visa journey like a delivery dashboard</li>
      </ul>
      
      <div id="profileEmail"></div>
      <div id="profileUID"></div>
    </div>

    <!-- Checklist Tab -->
    <div id="tab-checklist" class="tabSection" style="display: none;">
      <h2 id="questsHeader">Visa Checklist</h2>
      <ul id="questsList"></ul>
    </div>

    <!-- Countdown Tab -->
    <div id="tab-countdown" class="tabSection" style="display: none;">
      <div id="visaCountdown" style="margin-top: 1rem; font-weight: bold;">
        ⏳ Visa expires in: <span id="daysLeft">--</span> days
        <br><br>
        <label for="visaDate">📅 Set your visa expiration date:</label>
        <input type="date" id="visaDate" />
      </div>
      
      <div id="visaWarning" style="color: red; font-weight: bold; display: none; margin-top: 1rem;">
        ⚠️ Your visa is about to expire! Please take action.
      </div>
    </div>

    <!-- TM30 Tab -->
    <div id="tab-tm30" class="tabSection" style="display: none;">
      <h2>🧾 Upload TM30 Form</h2>
      <form id="tm30Form">
        <label for="tm30File">Choose your TM30 PDF or image:</label><br>
        <input type="file" id="tm30File" accept=".pdf,.jpg,.jpeg,.png" required /><br><br>
        
        <label for="tm30Date">📅 Submission Date:</label><br>
        <input type="date" id="tm30Date" required /><br><br>
        
        <label for="tm30Notes">📝 Notes (optional):</label><br>
        <textarea id="tm30Notes" rows="3" placeholder="e.g. Submitted at Chiang Mai Immigration Office"></textarea><br><br>
        
        <button type="submit">Upload</button>
      </form>
      <p id="tm30Status" style="color: green; display: none;">✅ TM30 uploaded successfully!</p>
    </div>

    <!-- Visa Types Tab -->
    <div id="tab-visaTypes" class="tabSection" style="display: none;">
      <h2 id="visaHeader">📅 Visa Types in Thailand</h2>
      <ul id="visaList"></ul>
      
      <h3>📊 Visa Comparison</h3>
      <table>
        <thead>
          <tr>
            <th>Visa Type</th>
            <th>Duration</th>
            <th>Extension</th>
            <th>Cost (THB)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Tourist (TR)</td>
            <td>60 days</td>
            <td>+30 days</td>
            <td>1,900</td>
          </tr>
          <tr>
            <td>Education (ED)</td>
            <td>90 days</td>
            <td>Renewable</td>
            <td>2,000+</td>
          </tr>
          <tr>
            <td>Non-O</td>
            <td>90 days</td>
            <td>1 year</td>
            <td>1,900</td>
          </tr>
          <tr>
            <td>Non-B</td>
            <td>90 days</td>
            <td>1 year</td>
            <td>2,000+</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <script>
    // Service Worker Registration
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js')
        .then(reg => console.log('✅ Service Worker registered:', reg.scope))
        .catch(err => console.error('❌ Service Worker registration failed:', err));
    }

    // Tab switching functionality
    window.showTab = function(tabName) {
      // Hide all tabs
      const tabs = document.querySelectorAll('.tabSection');
      tabs.forEach(tab => tab.style.display = 'none');
      
      // Remove active class from all buttons
      const buttons = document.querySelectorAll('.tabBtn');
      buttons.forEach(btn => btn.classList.remove('active'));
      
      // Show selected tab
      const selectedTab = document.getElementById('tab-' + tabName);
      if (selectedTab) {
        selectedTab.style.display = 'block';
      }
      
      // Add active class to clicked button
      event.target.classList.add('active');
    };
  </script>
  <script type="module" src="main.js"></script>
</body>
</html>